Using GPU for training!
Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount("/content/drive", force_remount=True).
Data folder path: /content/drive/MyDrive/balanced_data_sweet
Train shape (raw): (8112016, 6) Val shape (raw): (2027872, 6) Test shape (raw): (2535104, 6)
Unique users in train: [  85   91   93   94   95   96   97   98   99  103  104  105  106  108
  115  117  118  122  125  127  129  130  132  135  141  149  151  155
  160  166  170  173  174  181  182  183  184  186  188  189  192  195
  196  197  199  202  205  206  207  208  211  212  213  214  215  217
  218  219  220  221  224  226  227  228  234  236  238  239  240  245
  249  251  253  257  259  260  262  269  272  274  275  276  277  278
  279  280  301  302  303  340  350  378  842  843  846  849  850  852
  854  862  864  867  869  871  873  880  881  886  887  888  892  893
  894  895  897  901  904  905  907  908  910  915  916  918  919  922
  925  926  927  928  930  931  933  937  940  941  942  947  953  963
  966  969  971  979  980  981  994  997  998 1002 1005 1012 1013 1019
 1025 1026 1027 1028 1040 1061 1064 1065 1067 1069 1077 1089 1091 1092
 1105 1108 1120 1121 1129 1138 1144 1150]
Unique users in val: [  85   91   93   94   95   96   97   98   99  103  104  105  106  108
  115  117  118  122  125  127  129  130  132  135  141  149  151  155
  160  166  170  173  174  181  182  183  184  186  188  189  192  195
  196  197  199  202  205  206  207  208  211  212  213  214  215  217
  218  219  220  221  224  226  227  228  234  236  238  239  240  245
  249  251  253  257  259  260  262  269  272  274  275  276  277  278
  279  280  301  302  303  340  350  378  842  843  846  849  850  852
  854  862  864  867  869  871  873  880  881  886  887  888  892  893
  894  895  897  901  904  905  907  908  910  915  916  918  919  922
  925  926  927  928  930  931  933  937  940  941  942  947  953  963
  966  969  971  979  980  981  994  997  998 1002 1005 1012 1013 1019
 1025 1026 1027 1028 1040 1061 1064 1065 1067 1069 1077 1089 1091 1092
 1105 1108 1120 1121 1129 1138 1144 1150]
Unique users in test: [  85   91   93   94   95   96   97   98   99  103  104  105  106  108
  115  117  118  122  125  127  129  130  132  135  141  149  151  155
  160  166  170  173  174  181  182  183  184  186  188  189  192  195
  196  197  199  202  205  206  207  208  211  212  213  214  215  217
  218  219  220  221  224  226  227  228  234  236  238  239  240  245
  249  251  253  257  259  260  262  269  272  274  275  276  277  278
  279  280  301  302  303  340  350  378  842  843  846  849  850  852
  854  862  864  867  869  871  873  880  881  886  887  888  892  893
  894  895  897  901  904  905  907  908  910  915  916  918  919  922
  925  926  927  928  930  931  933  937  940  941  942  947  953  963
  966  969  971  979  980  981  994  997  998 1002 1005 1012 1013 1019
 1025 1026 1027 1028 1040 1061 1064 1065 1067 1069 1077 1089 1091 1092
 1105 1108 1120 1121 1129 1138 1144 1150]
Number of classes (users): 176
train_steps=253500, val_steps=63370

Using LSTM model...

/usr/local/lib/python3.10/dist-packages/keras/src/layers/rnn/rnn.py:204: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(**kwargs)
253500/253500 ━━━━━━━━━━━━━━━━━━━━ 1533s 6ms/step - accuracy: 0.9490 - loss: 0.1910 - val_accuracy: 0.9973 - val_loss: 0.0172
79222/79222 ━━━━━━━━━━━━━━━━━━━━ 210s 3ms/step - accuracy: 0.9977 - loss: 0.0143
Test Accuracy: 99.74%
              precision    recall  f1-score   support

          85       1.00      1.00      1.00     14404
          91       1.00      1.00      1.00     14404
          93       1.00      1.00      1.00     14395
          94       1.00      1.00      1.00     14404
          95       1.00      1.00      1.00     14404
          96       1.00      1.00      1.00     14404
          97       1.00      1.00      1.00     14404
          98       1.00      1.00      1.00     14404
          99       1.00      1.00      1.00     14404
         103       1.00      0.99      1.00     14404
         104       1.00      1.00      1.00     14404
         105       1.00      1.00      1.00     14404
         106       1.00      1.00      1.00     14404
         108       1.00      1.00      1.00     14404
         115       1.00      0.99      1.00     14404
         117       1.00      1.00      1.00     14404
         118       1.00      1.00      1.00     14404
         122       0.99      1.00      0.99     14404
         125       1.00      0.99      0.99     14404
         127       1.00      1.00      1.00     14404
         129       1.00      1.00      1.00     14404
         130       1.00      1.00      1.00     14404
         132       1.00      1.00      1.00     14404
         135       1.00      1.00      1.00     14404
         141       1.00      1.00      1.00     14404
         149       1.00      1.00      1.00     14404
         151       1.00      1.00      1.00     14404
         155       1.00      1.00      1.00     14404
         160       1.00      1.00      1.00     14404
         166       0.97      1.00      0.98     14404
         170       1.00      1.00      1.00     14404
         173       0.99      1.00      1.00     14404
         174       1.00      1.00      1.00     14404
         181       1.00      1.00      1.00     14404
         182       1.00      1.00      1.00     14404
         183       1.00      1.00      1.00     14404
         184       1.00      1.00      1.00     14404
         186       1.00      1.00      1.00     14404
         188       1.00      1.00      1.00     14404
         189       1.00      1.00      1.00     14404
         192       1.00      1.00      1.00     14404
         195       1.00      1.00      1.00     14404
         196       1.00      1.00      1.00     14404
         197       1.00      1.00      1.00     14404
         199       1.00      1.00      1.00     14404
         202       1.00      1.00      1.00     14404
         205       1.00      1.00      1.00     14404
         206       1.00      1.00      1.00     14404
         207       1.00      1.00      1.00     14404
         208       1.00      1.00      1.00     14404
         211       1.00      1.00      1.00     14404
         212       1.00      1.00      1.00     14404
         213       1.00      1.00      1.00     14404
         214       1.00      0.99      1.00     14404
         215       1.00      1.00      1.00     14404
         217       1.00      1.00      1.00     14404
         218       1.00      1.00      1.00     14404
         219       1.00      1.00      1.00     14404
         220       1.00      1.00      1.00     14404
         221       1.00      1.00      1.00     14404
         224       1.00      1.00      1.00     14404
         226       1.00      1.00      1.00     14404
         227       1.00      1.00      1.00     14404
         228       1.00      1.00      1.00     14404
         234       1.00      1.00      1.00     14404
         236       1.00      1.00      1.00     14404
         238       1.00      1.00      1.00     14404
         239       1.00      1.00      1.00     14404
         240       1.00      0.99      1.00     14404
         245       0.99      0.99      0.99     14404
         249       1.00      1.00      1.00     14404
         251       1.00      1.00      1.00     14404
         253       1.00      1.00      1.00     14404
         257       1.00      1.00      1.00     14404
         259       1.00      1.00      1.00     14404
         260       1.00      1.00      1.00     14404
         262       1.00      1.00      1.00     14404
         269       1.00      1.00      1.00     14404
         272       1.00      1.00      1.00     14404
         274       1.00      1.00      1.00     14404
         275       1.00      1.00      1.00     14404
         276       0.98      1.00      0.99     14404
         277       1.00      1.00      1.00     14404
         278       1.00      1.00      1.00     14404
         279       1.00      1.00      1.00     14404
         280       1.00      1.00      1.00     14404
         301       1.00      1.00      1.00     14404
         302       1.00      1.00      1.00     14404
         303       1.00      0.99      1.00     14404
         340       1.00      1.00      1.00     14404
         350       1.00      1.00      1.00     14404
         378       1.00      1.00      1.00     14404
         842       1.00      1.00      1.00     14404
         843       1.00      0.99      1.00     14404
         846       0.99      1.00      1.00     14404
         849       1.00      0.99      0.99     14404
         850       0.99      1.00      1.00     14404
         852       1.00      1.00      1.00     14404
         854       1.00      1.00      1.00     14404
         862       1.00      1.00      1.00     14404
         864       1.00      1.00      1.00     14404
         867       1.00      1.00      1.00     14404
         869       1.00      0.99      1.00     14404
         871       1.00      1.00      1.00     14404
         873       0.97      1.00      0.98     14404
         880       0.99      1.00      1.00     14404
         881       1.00      1.00      1.00     14404
         886       1.00      1.00      1.00     14404
         887       1.00      1.00      1.00     14404
         888       1.00      0.99      1.00     14404
         892       1.00      1.00      1.00     14404
         893       1.00      1.00      1.00     14404
         894       1.00      1.00      1.00     14404
         895       1.00      1.00      1.00     14404
         897       1.00      0.99      0.99     14404
         901       1.00      1.00      1.00     14404
         904       1.00      1.00      1.00     14404
         905       1.00      1.00      1.00     14404
         907       1.00      0.99      1.00     14404
         908       1.00      1.00      1.00     14404
         910       1.00      1.00      1.00     14404
         915       1.00      1.00      1.00     14404
         916       1.00      1.00      1.00     14404
         918       1.00      1.00      1.00     14404
         919       0.99      1.00      1.00     14404
         922       1.00      1.00      1.00     14404
         925       1.00      0.99      1.00     14404
         926       1.00      1.00      1.00     14404
         927       0.99      1.00      0.99     14404
         928       1.00      1.00      1.00     14404
         930       0.99      0.99      0.99     14404
         931       0.99      1.00      0.99     14404
         933       1.00      1.00      1.00     14404
         937       1.00      1.00      1.00     14404
         940       1.00      1.00      1.00     14404
         941       1.00      0.99      1.00     14404
         942       1.00      1.00      1.00     14404
         947       1.00      1.00      1.00     14404
         953       1.00      1.00      1.00     14404
         963       1.00      1.00      1.00     14404
         966       1.00      1.00      1.00     14404
         969       0.99      1.00      1.00     14404
         971       1.00      1.00      1.00     14404
         979       0.99      1.00      1.00     14404
         980       1.00      1.00      1.00     14404
         981       1.00      1.00      1.00     14404
         994       0.99      1.00      1.00     14404
         997       1.00      1.00      1.00     14404
         998       0.99      1.00      1.00     14404
        1002       1.00      1.00      1.00     14404
        1005       1.00      0.98      0.99     14404
        1012       0.99      1.00      1.00     14404
        1013       1.00      1.00      1.00     14404
        1019       1.00      0.99      1.00     14404
        1025       0.99      1.00      1.00     14404
        1026       1.00      0.99      0.99     14404
        1027       1.00      1.00      1.00     14404
        1028       1.00      0.99      1.00     14404
        1040       1.00      1.00      1.00     14404
        1061       1.00      1.00      1.00     14404
        1064       1.00      1.00      1.00     14404
        1065       1.00      1.00      1.00     14404
        1067       1.00      1.00      1.00     14404
        1069       1.00      1.00      1.00     14404
        1077       1.00      1.00      1.00     14404
        1089       1.00      1.00      1.00     14404
        1091       1.00      1.00      1.00     14404
        1092       0.99      1.00      0.99     14404
        1105       1.00      1.00      1.00     14404
        1108       1.00      1.00      1.00     14404
        1120       1.00      0.99      1.00     14404
        1121       1.00      1.00      1.00     14404
        1129       1.00      1.00      1.00     14404
        1138       1.00      1.00      1.00     14404
        1144       1.00      1.00      1.00     14404
        1150       1.00      1.00      1.00     14403

    accuracy                           1.00   2535094
   macro avg       1.00      1.00      1.00   2535094
weighted avg       1.00      1.00      1.00   2535094


Equal Error Rate (EER) per class (one-vs-rest):
  Class 85 => EER: 0.03%
  Class 91 => EER: 0.02%
  Class 93 => EER: 0.05%
  Class 94 => EER: 0.02%
  Class 95 => EER: 0.02%
  Class 96 => EER: 0.02%
  Class 97 => EER: 0.03%
  Class 98 => EER: 0.02%
  Class 99 => EER: 0.03%
  Class 103 => EER: 0.03%
  Class 104 => EER: 0.03%
  Class 105 => EER: 0.04%
  Class 106 => EER: 0.05%
  Class 108 => EER: 0.06%
  Class 115 => EER: 0.03%
  Class 117 => EER: 0.02%
  Class 118 => EER: 0.03%
  Class 122 => EER: 0.06%
  Class 125 => EER: 0.08%
  Class 127 => EER: 0.04%
  Class 129 => EER: 0.02%
  Class 130 => EER: 0.02%
  Class 132 => EER: 0.07%
  Class 135 => EER: 0.04%
  Class 141 => EER: 0.07%
  Class 149 => EER: 0.05%
  Class 151 => EER: 0.05%
  Class 155 => EER: 0.03%
  Class 160 => EER: 0.03%
  Class 166 => EER: 0.07%
  Class 170 => EER: 0.04%
  Class 173 => EER: 0.02%
  Class 174 => EER: 0.04%
  Class 181 => EER: 0.04%
  Class 182 => EER: 0.04%
  Class 183 => EER: 0.03%
  Class 184 => EER: 0.02%
  Class 186 => EER: 0.04%
  Class 188 => EER: 0.01%
  Class 189 => EER: 0.00%
  Class 192 => EER: 0.03%
  Class 195 => EER: 0.05%
  Class 196 => EER: 0.01%
  Class 197 => EER: 0.05%
  Class 199 => EER: 0.05%
  Class 202 => EER: 0.01%
  Class 205 => EER: 0.01%
  Class 206 => EER: 0.02%
  Class 207 => EER: 0.02%
  Class 208 => EER: 0.01%
  Class 211 => EER: 0.02%
  Class 212 => EER: 0.02%
  Class 213 => EER: 0.03%
  Class 214 => EER: 0.01%
  Class 215 => EER: 0.04%
  Class 217 => EER: 0.02%
  Class 218 => EER: 0.01%
  Class 219 => EER: 0.03%
  Class 220 => EER: 0.02%
  Class 221 => EER: 0.02%
  Class 224 => EER: 0.01%
  Class 226 => EER: 0.01%
  Class 227 => EER: 0.05%
  Class 228 => EER: 0.03%
  Class 234 => EER: 0.04%
  Class 236 => EER: 0.03%
  Class 238 => EER: 0.02%
  Class 239 => EER: 0.01%
  Class 240 => EER: 0.07%
  Class 245 => EER: 0.05%
  Class 249 => EER: 0.04%
  Class 251 => EER: 0.02%
  Class 253 => EER: 0.04%
  Class 257 => EER: 0.02%
  Class 259 => EER: 0.03%
  Class 260 => EER: 0.07%
  Class 262 => EER: 0.01%
  Class 269 => EER: 0.03%
  Class 272 => EER: 0.01%
  Class 274 => EER: 0.05%
  Class 275 => EER: 0.03%
  Class 276 => EER: 0.04%
  Class 277 => EER: 0.01%
  Class 278 => EER: 0.07%
  Class 279 => EER: 0.02%
  Class 280 => EER: 0.04%
  Class 301 => EER: 0.02%
  Class 302 => EER: 0.06%
  Class 303 => EER: 0.03%
  Class 340 => EER: 0.09%
  Class 350 => EER: 0.03%
  Class 378 => EER: 0.03%
  Class 842 => EER: 0.02%
  Class 843 => EER: 0.06%
  Class 846 => EER: 0.06%
  Class 849 => EER: 0.06%
  Class 850 => EER: 0.04%
  Class 852 => EER: 0.01%
  Class 854 => EER: 0.00%
  Class 862 => EER: 0.01%
  Class 864 => EER: 0.03%
  Class 867 => EER: 0.03%
  Class 869 => EER: 0.07%
  Class 871 => EER: 0.04%
  Class 873 => EER: 0.05%
  Class 880 => EER: 0.06%
  Class 881 => EER: 0.01%
  Class 886 => EER: 0.03%
  Class 887 => EER: 0.04%
  Class 888 => EER: 0.04%
  Class 892 => EER: 0.03%
  Class 893 => EER: 0.03%
  Class 894 => EER: 0.03%
  Class 895 => EER: 0.02%
  Class 897 => EER: 0.08%
  Class 901 => EER: 0.03%
  Class 904 => EER: 0.03%
  Class 905 => EER: 0.03%
  Class 907 => EER: 0.07%
  Class 908 => EER: 0.03%
  Class 910 => EER: 0.04%
  Class 915 => EER: 0.02%
  Class 916 => EER: 0.04%
  Class 918 => EER: 0.07%
  Class 919 => EER: 0.03%
  Class 922 => EER: 0.02%
  Class 925 => EER: 0.05%
  Class 926 => EER: 0.04%
  Class 927 => EER: 0.04%
  Class 928 => EER: 0.01%
  Class 930 => EER: 0.06%
  Class 931 => EER: 0.06%
  Class 933 => EER: 0.01%
  Class 937 => EER: 0.02%
  Class 940 => EER: 0.03%
  Class 941 => EER: 0.04%
  Class 942 => EER: 0.05%
  Class 947 => EER: 0.03%
  Class 953 => EER: 0.05%
  Class 963 => EER: 0.04%
  Class 966 => EER: 0.01%
  Class 969 => EER: 0.04%
  Class 971 => EER: 0.04%
  Class 979 => EER: 0.04%
  Class 980 => EER: 0.04%
  Class 981 => EER: 0.11%
  Class 994 => EER: 0.04%
  Class 997 => EER: 0.04%
  Class 998 => EER: 0.07%
  Class 1002 => EER: 0.03%
  Class 1005 => EER: 0.08%
  Class 1012 => EER: 0.04%
  Class 1013 => EER: 0.05%
  Class 1019 => EER: 0.06%
  Class 1025 => EER: 0.06%
  Class 1026 => EER: 0.05%
  Class 1027 => EER: 0.02%
  Class 1028 => EER: 0.08%
  Class 1040 => EER: 0.00%
  Class 1061 => EER: 0.02%
  Class 1064 => EER: 0.05%
  Class 1065 => EER: 0.02%
  Class 1067 => EER: 0.02%
  Class 1069 => EER: 0.05%
  Class 1077 => EER: 0.03%
  Class 1089 => EER: 0.05%
  Class 1091 => EER: 0.01%
  Class 1092 => EER: 0.04%
  Class 1105 => EER: 0.03%
  Class 1108 => EER: 0.04%
  Class 1120 => EER: 0.04%
  Class 1121 => EER: 0.07%
  Class 1129 => EER: 0.04%
  Class 1138 => EER: 0.06%
  Class 1144 => EER: 0.03%
  Class 1150 => EER: 0.05%

Average EER across classes: 0.04%